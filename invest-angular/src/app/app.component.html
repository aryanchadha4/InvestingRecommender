<div class="container">

  <h1>{{ title }}</h1>
  <section class="grid">
    <label>
      <span>Amount ($)</span>
      <input type="number" min="0" step="100" [ngModel]="amount()" (ngModelChange)="amount.set($event)" />
    </label>
    <label>
      <span>Risk</span>
      <select [ngModel]="risk()" (ngModelChange)="risk.set($event)">
        <option value="conservative">Conservative</option>
        <option value="balanced">Balanced</option>
        <option value="aggressive">Aggressive</option>
      </select>
    </label>
    <label class="wide">
      <span>Symbols (comma-separated)</span>
      <input type="text" [ngModel]="symbolsText()" (ngModelChange)="symbolsText.set($event)" />
    </label>
  </section>
  <div class="buttons">
    <button (click)="recommend()" [disabled]="loading()">Get Recommendation</button>
    <button (click)="backfill()" [disabled]="loading()">Backfill Prices</button>
    <button (click)="compute()" [disabled]="loading()">Compute Signals</button>
    <button (click)="buildUniverse()" [disabled]="loading()">Build Universe (Top {{ universeCount() }} + ETFs)</button>
  </div>
  <details>
    <summary>Current Universe ({{ universeSymbols().length }} symbols)</summary>
    <div style="max-height:200px; overflow:auto; font-family:monospace;">
      {{ universeSymbols().join(', ') }}
    </div>
  </details>
  <p class="error" *ngIf="error()">{{ error() }}</p>
  <p *ngIf="loading()">Loadingâ€¦</p>
  <section *ngIf="data()" class="results">
    <h2>Allocation</h2>
    <table>
      <thead>
        <tr><th>Symbol</th><th>Weight</th><th>Dollars</th></tr>
      </thead>
      <tbody>
        <tr *ngFor="let pair of weightEntries(); trackBy: trackBySym">
          <td>{{ pair[0] }}</td>
          <td>{{ pair[1] | number:'1.3-3' }}</td>
          <td>${{ dollar(pair[0]) | number:'1.0-0' }}</td>
        </tr>
      </tbody>
    </table>
    <p class="meta">Covariance window: {{ data()?.cov_estimation_days }} days</p>
    <details>
      <summary>Signals</summary>
      <pre>{{ data()?.signals | json }}</pre>
    </details>
  </section>
</div>

